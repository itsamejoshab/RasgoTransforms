-- args: {{dimensions}}, {{list_of_vals}}, {{list_of_vals_no_quote}}, {{pivot_column}}, {{value_column}}, {{agg_method}}

SELECT {{dimensions}}, {{list_of_vals_no_quote}} FROM ( select {{dimensions}}, {{pivot_column}}, {{value_column}} from {{source_table}}) PIVOT ( {{agg_method}} ( {{pivot_column}} ) FOR {{value_column}} IN ( {{list_of_vals}} ) ) as p ( {{dimensions}}, {{list_of_vals_no_quote}})