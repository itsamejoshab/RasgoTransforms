-- Args: {{date_part}}, {{dateColumn}}
-- date_part: ['year','month','day','week','quarter','hour','minute','second','millisecond','microsecond']

select *,

{%- for col in dateColumn -%}
    DATE_TRUNC({{date_part}}, {{col}}) as {{col}}_{{date_part}} {{ ", " if not loop.last else "" }}
{%- endfor -%}
from {source_table}